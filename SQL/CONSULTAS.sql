USE DBNEONET;

--TOTAL VENTAS POR CLIENTE 
SELECT 
    C.NOMBRE,
    SUM(DV.CANTIDAD * DV.PRECIO_UNITARIO) AS TOTAL_VENDIDO
FROM 
	CLIENTES C
	JOIN VENTAS V 
		ON C.ID = V.CLIENTE_ID
	JOIN DETALLEVENTA DV 
		ON V.ID = DV.VENTA_ID
GROUP BY
	C.NOMBRE;


--PRODUCTOS MAS VENDIDOS
SELECT
    P.NOMBRE,
    SUM(DV.CANTIDAD) AS TOTAL_VENDIDO
FROM 
	PRODUCTOS P
	JOIN DETALLEVENTA DV 
	ON P.ID = DV.PRODUCTO_ID
GROUP BY 
	P.NOMBRE
ORDER BY 
	TOTAL_VENDIDO DESC;


--STOCK ACTUAL 
SELECT
    NOMBRE,
    STOCK
FROM 
	PRODUCTOS;

